<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DENT 545 • Lab Quiz: Model Selection (Written)</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-slate-100 p-6 font-sans text-slate-800">
  <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg border-b-8 border-[#FFDB05] overflow-hidden">

    <!-- Header -->
    <div class="bg-[#007C41] p-6 text-white flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-extrabold">Lab Quiz (Written): Model Selection</h1>
        <p class="text-sm opacity-90">Chapter 6 • Ridge vs Lasso • CV vs Bootstrap</p>
      </div>
      <a href="./index.html" class="bg-white/15 hover:bg-white/25 px-4 py-2 rounded-lg text-sm font-bold">
        ← Back to Quiz
      </a>
    </div>

    <!-- Content -->
    <div class="p-6 space-y-6">

      <!-- CCID -->
      <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
        <label class="block font-bold mb-2">UAlberta CCID (required)</label>
        <input id="ccid" type="text" placeholder="e.g., smith1"
               class="w-full md:w-80 px-4 py-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-[#007C41]" />
        <p id="ccid-error" class="text-red-600 text-sm mt-2 hidden">Please enter a valid CCID (letters/numbers only).</p>
      </div>

      <!-- Questions -->
      <div id="questions" class="space-y-5"></div>

      <!-- Submit -->
      <div class="flex items-center gap-3 pt-2">
        <button id="submitBtn"
          class="bg-[#007C41] hover:bg-[#005c30] text-white px-6 py-3 rounded-lg font-bold">
          Submit Lab Quiz
        </button>
        <span id="status" class="text-sm font-bold"></span>
      </div>

      <p class="text-xs text-slate-500">
        Your responses are recorded in the course analytics sheet. Do not include any patient identifiers.
      </p>

    </div>
  </div>

<script>
  // ===== CONFIG =====
  const API_URL = "https://script.google.com/macros/s/AKfycbz7oxU1A2xUpB3ZFbhMOLbC7KKybDvxUGeZCnxFUAJX6ty-29jrbgDDA74F6pnX5DfM/exec";
  const QUIZ_ID = "Model Selection - Lab (Written)";

  // ===== QUESTIONS (written) =====
  const PROMPTS = [
    "Q1. What was the best C for Ridge (L2) in your run, and what does that imply about regularization strength?",
    "Q2. What was the best C for Lasso (L1), and how does it compare to Ridge in regularization strength?",
    "Q3. Which model had higher CV AUC (Ridge vs Lasso)? Provide the approximate AUC values.",
    "Q4. Which model performed better on the holdout test set? Provide accuracy (and AUC if available).",
    "Q5. Why can CV results and holdout results disagree? Explain in 2–4 sentences.",
    "Q6. Which model looked more stable using bootstrap (mean + std)? Explain what 'stability' means here.",
    "Q7. What does the bootstrap distribution (histogram) add that a single accuracy number does not?",
    "Q8. Did Lasso do meaningful feature selection in your run? Use the non-zero coefficient count to justify.",
    "Q9. When predictors are highly correlated, why is Ridge often preferred?",
    "Q10. If this were a text model with thousands of features, which regularization (Ridge vs Lasso) would you consider and why?"
  ];

  // Render questions with big text areas
  const container = document.getElementById("questions");
  PROMPTS.forEach((text, i) => {
    const card = document.createElement("div");
    card.className = "bg-slate-50 border border-slate-200 rounded-lg p-4";
    card.innerHTML = `
      <p class="font-extrabold mb-2">${text}</p>
      <textarea id="Q${i+1}" class="w-full min-h-[140px] p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-[#007C41]"
        placeholder="Write your answer here..."></textarea>
    `;
    container.appendChild(card);
  });

  function getCCID() {
    const el = document.getElementById("ccid");
    const err = document.getElementById("ccid-error");
    const ccid = (el.value || "").trim().toLowerCase();
    const ok = /^[a-z0-9]{2,16}$/.test(ccid);
    if (!ok) {
      err.classList.remove("hidden");
      el.focus();
      return null;
    }
    err.classList.add("hidden");
    return ccid;
  }

  function collectAnswers() {
    const answers = {};
    for (let i = 1; i <= PROMPTS.length; i++) {
      answers[`Q${i}`] = document.getElementById(`Q${i}`).value.trim();
    }
    return answers;
  }

  async function submit() {
    const status = document.getElementById("status");
    const btn = document.getElementById("submitBtn");

    const ccid = getCCID();
    if (!ccid) return;

    status.textContent = "Submitting...";
    btn.disabled = true;

    const answers = collectAnswers();

    try {
      await fetch(API_URL, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          quiz_id: QUIZ_ID,
          student_id: ccid,
          answers: answers
        })
      });

      status.textContent = "Submitted ✅ Thank you!";
    } catch (e) {
      console.error(e);
      status.textContent = "Submission failed ❌ Try again.";
      btn.disabled = false;
    }
  }

  document.getElementById("submitBtn").addEventListener("click", submit);
</script>

</body>
</html>
